schema_version: "1.0"

pr:
  number: 60283
  title: "fix indentation in a GC function"
  url: "https://github.com/JuliaLang/julia/pull/60283"
  diff_url: "https://github.com/JuliaLang/julia/pull/60283.diff"
  author: "d-netto"
  labels:
    - "GC"
  merged_at: "2025-11-30T17:24:30Z"
  merge_commit_sha: "b135c3f581c04108d3056be6b4ef374be5a82605"

scope:
  files_touched:
    - "src/gc-stock.c"
  components:
    - "GC"
  pipeline_stages:
    - "Runtime"

analysis:
  intent:
    summary: |
      Pure cosmetic fix correcting indentation of a closing brace in the sweep_big()
      function within the garbage collector. No functional or semantic changes.
    issue_links: []

  direct_changes:
    - summary: "Fix indentation of closing brace in sweep_big function"
      component: "GC"
      evidence:
        - source: "diff"
          path: "src/gc-stock.c"
          loc: "543-550"
          url: "https://github.com/JuliaLang/julia/blob/b135c3f581c04108d3056be6b4ef374be5a82605/src/gc-stock.c#L543-L550"
          snippet: |
            # Git diff output showing the exact change:
            @@ -543,7 +543,7 @@ static void sweep_big(jl_ptls_t ptls) JL_NOTSAFEPOINT
                     jl_ptls_t ptls2 = gc_all_tls_states[i];
                     if (ptls2 == NULL) {
                         continue;
            -    }
            +        }
                     bigval_t *last_node = sweep_list_of_young_bigvals(ptls2->gc_tls.heap.young_generation_of_bigvals);
                     if (ptls == ptls2) {
                         last_node_in_my_list = last_node;
            # The closing brace was at 4 spaces (column 5) instead of 8 spaces (column 9)
        - source: "code"
          path: "src/gc-stock.c"
          loc: "537-564"
          url: "https://github.com/JuliaLang/julia/blob/b135c3f581c04108d3056be6b4ef374be5a82605/src/gc-stock.c#L537-L564"
          snippet: |
            static void sweep_big(jl_ptls_t ptls) JL_NOTSAFEPOINT
            {
                gc_time_big_start();
                assert(gc_n_threads != 0);
                bigval_t *last_node_in_my_list = NULL;
                for (int i = 0; i < gc_n_threads; i++) {
                    jl_ptls_t ptls2 = gc_all_tls_states[i];
                    if (ptls2 == NULL) {
                        continue;
                    }  // <-- line 546: this brace was the fix target (now correctly indented)
                    bigval_t *last_node = sweep_list_of_young_bigvals(ptls2->gc_tls.heap.young_generation_of_bigvals);
                    if (ptls == ptls2) {
                        last_node_in_my_list = last_node;
                    }
                }
                if (current_sweep_full) {
                    sweep_list_of_oldest_bigvals(ptls->gc_tls.heap.young_generation_of_bigvals);
                    // move all nodes in `oldest_generation_of_bigvals` to my list of bigvals
                    assert(last_node_in_my_list != NULL);
                    assert(last_node_in_my_list->next == NULL);
                    last_node_in_my_list->next = oldest_generation_of_bigvals->next; // skip the sentinel
                    if (oldest_generation_of_bigvals->next != NULL) {
                        oldest_generation_of_bigvals->next->prev = last_node_in_my_list;
                    }
                    oldest_generation_of_bigvals->next = NULL;
                }
                gc_time_big_end();
            }
        - source: "code"
          path: "src/gc-stock.c"
          loc: "997-1007"
          url: "https://github.com/JuliaLang/julia/blob/b135c3f581c04108d3056be6b4ef374be5a82605/src/gc-stock.c#L997-L1007"
          snippet: |
            // Call chain showing where sweep_big is invoked:
            // sweep over all memory that is being used and not in a pool
            static void gc_sweep_other(jl_ptls_t ptls, int sweep_full) JL_NOTSAFEPOINT
            {
                uint64_t t_free_mallocd_memory_start = jl_hrtime();
                gc_sweep_foreign_objs();
                sweep_malloced_memory();
                sweep_big(ptls);  // <-- sole caller of sweep_big
                uint64_t t_free_mallocd_memory_end = jl_hrtime();
                gc_num.total_sweep_free_mallocd_memory_time += t_free_mallocd_memory_end - t_free_mallocd_memory_start;
                jl_engine_sweep(gc_all_tls_states);
            }

  secondary_effects: []

  compatibility:
    internal_api: []
    behavioral: []

  performance:
    compile_time: []
    runtime: []

  risk:
    level: "low"
    rationale:
      - "Pure whitespace/indentation change with zero semantic impact"
      - "No code logic modified - only formatting correction"
      - "Change is within a static function (sweep_big) not exposed via any API"
      - "sweep_big has only one caller: gc_sweep_other() at line 1003"
      - "The C compiler ignores whitespace - generated machine code is identical"
      - "Merged very quickly (2 minutes) with no review comments needed"
      - "Author (d-netto) is a Julia core team member specializing in GC"

  downstream_impact:
    affected_packages: []
    notes: |
      This PR has absolutely no impact on downstream packages. It is a cosmetic-only
      change fixing whitespace indentation in a C file. No behavior, API, or ABI changes.

  open_questions: []

  recommendations:
    - "No action required - this is a code style cleanup with no functional changes"

changelog_entry:
  category: "Internal"
  breaking: false
  summary: "Fixed indentation in GC sweep_big() function (cosmetic only)"
  details: |
    Corrected improper indentation of a closing brace in the sweep_big() function
    in src/gc-stock.c. This is a pure formatting fix with no behavioral changes.
